var vtpl=function(){"use strict";var e=new RegExp("([$\\w.\\[\\]]+)(?:\\|([$\\w.\\[\\]]+)(?::(.*))?)?"),t=/\s*("[^"]+"|[^,]+)\s*/g;var r=new RegExp("{{hack}}((?:.|[\r\n])*?){{/hack}}","igm"),n=new RegExp("\\s*\\b(?:break|case|catch|continue|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|this|throw|try|typeof|var|void|while|with|abstract|boolean|byte|char|class|const|debugger|double|enum|export|extends|final|float|goto|implements|import|int|interface|long|native|package|private|protected|public|short|static|super|synchronized|throws|transient|volatile|as|each|let|const)\\b\\s*|\\s*[\\+\\-\\*\\/%!\\?\\|\\^&~<>=,\\(\\)\\[\\];]+\\s*","ig");var a=/\{\{([^{}]*?)\}\}/g;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s={},i=s.toString,c=Object.getPrototypeOf,u=s.hasOwnProperty,f=u.toString,l=f.call(Object);function p(e){return null==e?e+"":"object"===(void 0===e?"undefined":o(e))||"function"==typeof e?s[i.call(e)]||"object":void 0===e?"undefined":o(e)}function h(e){var t,r;return!(!obj||"[object Object]"!==i.call(obj))&&(!(t=c(obj))||"function"==typeof(r=u.call(t,"constructor")&&t.constructor)&&f.call(r)===l)}"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(e){s["[object "+e+"]"]=e.toLowerCase()});var v=/%s/g,g=/%(\d+)\$s/g;function b(){if(arguments.length<2)throw"Too few arguments";var e,t,r,n=arguments[0];if((e="array"===p(arguments[1])?arguments[1]:Array.prototype.slice.call(arguments,1)).length<=0)throw"Too few arguments";if(r=(t=n.replace(g,function(t,r){var n=r-1;if(e[n])return e[n];throw"Tow few arguments"})).match(v)||[],1===e.length)return t.replace(v,e[0]);if(r.length>e.length)throw"Too few arguments";return t.replace(/%s/g,function(){return e.shift()})}var y="vtmpArr.push('%s');",d='vtmpArr.push(typeof %s === "number" ? %s : (%s || ""));',m="(function(scope){vtmpArr.push(scope.%s(%s));}(self));",w="(function(scope){var args=[%s];args.unshift(%s);vtmpArr.push(scope.%s.apply(scope, args));}(self));";"break case catch continue default delete do else finally for function if in instanceof new return switch this throw try typeof var void while with abstract boolean byte char class const debugger double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile".split(" ");function k(r){var a=["var vtmpArr = [];"],o=[];return r.forEach(function(r){var s=(r.content||"").trim();switch(r.type){case"string":a.push(b(y,r.content.replace(/[\r\n]+/g,"\\n").replace(/'/g,"\\'")));break;case"var":var i=function(r){if(!r)return null;var n=r.match(e);if(!n)return null;var a={};return a.content=n&&n[0],a.variable=n&&n[1],a.filter=n&&n[2],a.args=[],n[3]&&(a.args=n[3].match(t).map(function(e){return(e||"").trim()})),a}(s),c=(i.variable||"").split(/[\.\[\]]/)[0];if(o.indexOf(c)<0&&(a.unshift("var "+c+" = "+c+";"),o.push(c)),i.filter)if(i.args.length<=0)a.push(b(m,i.filter,i.variable));else{var u=b(w,i.args.join(","),i.variable,i.filter);a.push(u)}else a.push(b(d,s));break;case"if":case"for":case"elseif":(function(e){return e.split(n).filter(function(e){return e&&!e.match(/^\d+$/)&&!e.match(/^['"].*['"]$/)&&!e.match(/^\.+$/)}).map(function(e){return e.replace(/^\.+|\.+$/,"").split(/\./g)[0]})})(s).forEach(function(e){o.indexOf(e)<0&&(a.unshift("var "+e+" = "+e+";"),o.push(e))}),s.match(/^\(.*\)$/)||(s="("+s+")"),"elseif"===r.type?a.push("} else if "+s+" {"):a.push(";"+r.type+" "+s+" {");break;case"else":a.push("} else {");break;case"endif":case"endfor":a.push("}");break;case"each":var f=s.split(/\s+as\s+/);if(f.length<2)throw"[each] 缺少输入参数";var l=f[0],p=f[1].split(","),h=(p[0]||"").trim(),v=(p[1]||"").trim(),g=void 0;g=v?"Object.keys("+l+").forEach(function("+v+"){var "+h+" = "+l+"["+v+"];":"Object.values("+l+").forEach(function("+h+"){",a.push(g);break;case"endeach":a.push("});");break;case"set":var k=s.split(/\s+/),j=void 0;if(k.length<2)throw"[set] 缺少输入参数";0===k[0].indexOf("#")?(j=k[0].replace(/^#/,""),a.push("var "+j+";")):(j=k[0],o.indexOf(j)<0&&(a.unshift("var "+j+";"),o.push(j))),a.push(j+" = "+k[1]+";")}}),a.push('return vtmpArr.join("");'),a}function j(e,t){var r=function(){var e=["var $scope = {};"];return e.push("$scope.now = Date.now();"),e.push("var self = this;"),e}().concat(e).join("\n");return r=function(e,t){var r=new RegExp("<<HACK_MARK_\\d+>>","g");return e=e.replace(r,function(e){return t[e].replace(/[\r\n]/g,"\\n").replace(/'/g,"\\'")})}(r,t)}function x(){var e,t,r,n,a,s,i=arguments[0]||{},c=1,u=arguments.length,f=!1;for("boolean"==typeof i&&(f=i,i=arguments[c]||{},c++),"object"!==(void 0===i?"undefined":o(i))&&"function"!==p(i)&&(i={}),c===u&&(i=this,c--);c<u;c++)if(null!=(e=arguments[c]))for(t in e)r=i[t],i!==(n=e[t])&&(f&&n&&(h()||(a=Array.isArray(n)))?(a?(a=!1,s=r&&Array.isArray(r)?r:[]):s=r&&h()?r:{},i[t]=x(f,s,n)):void 0!==n&&(i[t]=n));return i}var A={};function O(e,t,n){var o=void 0;if(A[e]&&O.useCache)o=A[e];else{var s={};o=j(o=k(o=function(e){for(var t=void 0,r=void 0,n=0,o=0,s=void 0,i=void 0,c=void 0,u=void 0,f=[],l={};t=a.exec(e);){if(n=t.index,s=t[0],i=t[1],o<n&&(r=e.substring(o,n))&&f.push({type:"string",content:r}),i){switch(c=(u=i.split(/\s+/)).shift()){case"if":l={type:"if",content:u.join(" ")};break;case"elseif":case"elif":l={type:"elseif",content:u.join(" ")};break;case"else":l={type:"else"};break;case"/if":l={type:"endif"};break;case"for":case"each":l={type:c,content:u.join(" ")};break;case"/each":l={type:"endeach"};break;case"/for":l={type:"endfor"};break;case"set":l={type:"set",content:u.join(" ")};break;case"debug":break;default:l={type:"var",content:i}}f.push(l)}o=n+s.length}return o<e.length&&f.push({type:"string",content:e.substring(o)}),f}(o=function(e,t){var n=0;return e.replace(r,function(e,r){var a="<<HACK_MARK_"+n+">>";return t[a]=r,n++,a})}(o=function(e){return e?e.replace(/\*\*\*.*?(?:[\r\n]+|$)/g,"").replace(/\{\*(.|[\r\n])*?\*\}/g,"").trim():""}(e),s))),s),O.useCache&&(A[e]=o)}if(!t)return o;var i=Object.keys(t),c=Object.values(t);return n=n?x({},O.scope,n):O.scope,o=(o=function(e,t,r){e="try { "+e+" } catch(e) { console.error(e); }";try{return new Function(t,e)}catch(t){console.error(e),console.error(t)}}(o,i)).apply(n,c)}O.scope={},O.useCache=!0,O.register=function(e,t){this.scope[e]=t},O.unregister=function(e){delete this.scope[e]};var S="Y-M-D H:I:S";var E={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},$=new RegExp("[&<>\"']","igm");return O.register("datestr",function(e,t){var r=void 0;"string"==typeof e&&isNaN(e)&&(t=e,e=new Date),r=e?10===e.toString().length?new Date(1e3*e):new Date(e):new Date,t=t||S;var n=r.getMonth()+1,a=r.getDate(),o=r.getHours(),s=r.getMinutes(),i=r.getSeconds(),c={Y:r.getFullYear(),y:r.getYear(),M:n<10?"0"+n:n,m:n,D:a<10?"0"+a:a,d:a,H:o<10?"0"+o:o,h:o,I:s<10?"0"+s:s,i:s,S:i<10?"0"+i:i,s:i};return t.replace(/[YMDHISymdhis]/g,function(e){return c[e]})}),O.register("htmlspecialchars",function(e){return"string"==typeof e?e.replace($,function(e){return E[e]}):e}),O}();
//# sourceMappingURL=valleytpl.min.js.map
